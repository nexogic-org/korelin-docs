# Korelin 标准库文档

标准库是基于 C/C++ API 提供的封装，提供了一些常用的函数和类型，方便开发者使用。

## 1. os 库（操作系统交互）

提供操作系统级别的基本交互功能，如文件 I/O、系统命令等。

| 函数名 | 参数 | 返回值 | 功能说明 | 示例 |
|--------|------|--------|----------|------|
| `os.print` | ... (任意) | `void` | 标准输出，不换行 | `os.print("Hello", 123);` |
| `os.println` | ... (任意) | `void` | 标准输出，自动换行 | `os.println("Hello World");` |
| `os.input` | 无 | `string` | 读取标准输入一行 | `var name = os.input();` |
| `os.system` | `string` cmd | `void` | 执行系统 Shell 命令 | `os.system("dir");` |
| `os.printf` | `string` fmt, ... | `void` | 格式化输出 (占位符 `{}`) | `os.printf("Val: {}", 42);` |
| `os.open` | `string` path, `string` mode | `string` | 读取整个文件内容 | `var txt = os.open("f.txt", "r");` |
| `os.write` | `string` path, `string` content | `void` | 写入字符串到文件 | `os.write("f.txt", "Hello");` |
| `os.writeBytes` | `string` path, `array` bytes | `void` | 写入字节数组到文件 | `os.writeBytes("f.bin", bytes);` |
| `os.mkDir` | `string` path | `void` | 创建目录 | `os.mkDir("test/dir");` |
| `os.rmDir` | `string` path | `void` | 删除目录 | `os.rmDir("test/dir");` |
| `os.rmFile` | `string` path | `void` | 删除文件 | `os.rmFile("test.txt");` |
| `os.mkFile` | `string` path | `void` | 创建空文件 | `os.mkFile("new.txt");` |
| `os.getMainFilePath` | 无 | `string` | 获取主脚本路径 | `var p = os.getMainFilePath();` |
| `os.getOSName` | 无 | `string` | 获取操作系统名称 | `var n = os.getOSName();` |

## 2. time 库（时间处理）

提供时间获取、格式化与休眠功能。

| 函数名 | 参数 | 返回值 | 功能说明 | 示例 |
|--------|------|--------|----------|------|
| `time.now` | 无 | `int` | 当前时间戳 (毫秒) | `var t = time.now();` |
| `time.sleep` | `int` ms | `void` | 线程休眠 (毫秒) | `time.sleep(1000);` |
| `time.format` | `int` ts, `string` fmt | `string` | 格式化时间戳 | `time.format(t, "%Y-%m-%d");` |
| `time.getYear` | `int` ts | `int` | 获取年份 | `var y = time.getYear(t);` |
| `time.getMonth` | `int` ts | `int` | 获取月份 (1-12) | `var m = time.getMonth(t);` |
| `time.getDay` | `int` ts | `int` | 获取日期 (1-31) | `var d = time.getDay(t);` |
| `time.getHour` | `int` ts | `int` | 获取小时 (0-23) | `var h = time.getHour(t);` |
| `time.getMinute` | `int` ts | `int` | 获取分钟 (0-59) | `var m = time.getMinute(t);` |
| `time.getSecond` | `int` ts | `int` | 获取秒数 (0-59) | `var s = time.getSecond(t);` |

## 3. net 库（网络操作）

提供网络 I/O 原语，支持 TCP 和 HTTP。

| 函数名 | 参数 | 返回值 | 功能说明 | 示例 |
|--------|------|--------|----------|------|
| `net.dial` | `string` proto, `string` addr | `int` | 连接到服务器 (返回 Socket ID) | `var sock = net.dial("tcp", "127.0.0.1:80");` |
| `net.listen` | `string` proto, `string` addr | `int` | 监听端口 (返回 Listener ID) | `var l = net.listen("tcp", ":8080");` |
| `net.accept` | `int` listener | `int` | 接受连接 (返回 Conn ID) | `var conn = net.accept(l);` |
| `net.tcpSend` | `int` sock, `string` data | `void` | 发送数据 | `net.tcpSend(conn, "Hello");` |
| `net.tcpRecv` | `int` sock, `int` len | `string` | 接收数据 | `var msg = net.tcpRecv(conn, 1024);` |
| `net.tcpClose` | `int` sock | `void` | 关闭连接 | `net.tcpClose(conn);` |
| `net.httpGet` | `string` url | `string` | 发送 HTTP GET 请求 | `var html = net.httpGet("http://example.com");` |
| `net.httpPost` | `string` url, ... | `string` | 发送 HTTP POST 请求 (Stub) | `net.httpPost("...", "body");` |
| `net.getIP` | `string` domain | `string` | 解析域名 IP | `var ip = net.getIP("google.com");` |

## 4. string 库（字符串处理）

| 函数名 | 参数 | 返回值 | 功能说明 | 示例 |
|--------|------|--------|----------|------|
| `string.len` | `string` s | `int` | 获取长度 | `string.len("abc"); // 3` |
| `string.sub` | `string` s, `int` start, `int` end | `string` | 截取子串 | `string.sub("abcde", 1, 3); // "bc"` |
| `string.replace` | `string` s, `string` old, `string` new | `string` | 替换子串 (全量) | `string.replace("aba", "a", "c"); // "cbc"` |
| `string.toUpper` | `string` s | `string` | 转大写 | `string.toUpper("abc"); // "ABC"` |
| `string.toLower` | `string` s | `string` | 转小写 | `string.toLower("ABC"); // "abc"` |
| `string.trim` | `string` s | `string` | 去除首尾空格 | `string.trim(" a "); // "a"` |
| `string.split` | `string` s, `string` sep | `void` | 分割字符串 (Stub) | `string.split("a,b", ",");` |
| `string.join` | `array` arr, `string` sep | `string` | 连接数组元素 | `string.join(arr, ",");` |
| `string.indexOf` | `string` s, `string` sub | `int` | 查找子串位置 | `string.indexOf("abc", "b"); // 1` |

## 5. math 库（数学计算）

| 函数名 | 参数 | 返回值 | 功能说明 | 示例 |
|--------|------|--------|----------|------|
| `math.abs` | `number` n | `number` | 绝对值 | `math.abs(-1);` |
| `math.max` | `number` a, `number` b | `number` | 最大值 | `math.max(1, 2);` |
| `math.min` | `number` a, `number` b | `number` | 最小值 | `math.min(1, 2);` |
| `math.pow` | `number` b, `number` e | `number` | 幂运算 | `math.pow(2, 3);` |
| `math.sqrt` | `number` n | `float` | 开平方 | `math.sqrt(9);` |
| `math.round` | `float` n | `int` | 四舍五入 | `math.round(3.5);` |
| `math.random` | `int` min, `int` max | `int` | 随机整数 | `math.random(1, 100);` |
| `math.pi` | 无 | `float` | 圆周率 | `math.pi();` |

## 6. algorithm 库（算法）

| 函数名 | 参数 | 返回值 | 功能说明 | 示例 |
|--------|------|--------|----------|------|
| `algorithm.sort` | `array` arr | `void` | 数组排序 (Int Only) | `algorithm.sort(arr);` |
| `algorithm.reverse` | `array` arr | `void` | 数组反转 | `algorithm.reverse(arr);` |
| `algorithm.find` | `array` arr, `val` v | `int` | 查找元素索引 | `algorithm.find(arr, 10);` |
| `algorithm.sum` | `array` arr | `int` | 数组求和 (Int Only) | `algorithm.sum(arr);` |
| `algorithm.average` | `array` arr | `float` | 数组平均值 | `algorithm.average(arr);` |

## 7. json 库（JSON 处理）

| 函数名 | 参数 | 返回值 | 功能说明 | 示例 |
|--------|------|--------|----------|------|
| `json.parse` | `string` json | `object` | 解析 JSON | `var obj = json.parse("{\"a\":1}");` |
| `json.stringify` | `object` obj | `string` | 序列化 JSON (Stub) | `json.stringify(obj);` |
| `json.get` | `object` obj, `string` key | `value` | 获取字段 | `json.get(obj, "a");` |
| `json.set` | `object` obj, `string` key, `value` val | `void` | 设置字段 | `json.set(obj, "b", 2);` |

## 8. thread 库（线程）

> 注意：线程库目前为实验性功能，子线程無法安全访问父线程的對象（除全局常量外）。

| 函数名 | 参数 | 返回值 | 功能说明 | 示例 |
|--------|------|--------|----------|------|
| `thread.create` | `function` fn | `int` | 创建线程 (返回 Thread Handle) | `var t = thread.create(myTask);` |
| `thread.join` | `int` handle | `void` | 等待线程結束 | `thread.join(t);` |
| `thread.sleep` | `int` ms | `void` | 线程休眠 | `thread.sleep(100);` |
| `thread.id` | 无 | `int` | 获取当前线程 ID | `var id = thread.id();` |
| `thread.kill` | `int` handle | `void` | 强制终止线程 | `thread.kill(t);` |
| `thread.lock` | 无 | `void` | 获取全局锁 | `thread.lock();` |
| `thread.unlock` | 无 | `void` | 释放全局锁 | `thread.unlock();` |
| `thread.mutex` | 无 | `int` | 创建互斥锁 (返回 Mutex Handle) | `var m = thread.mutex();` |
| `thread.mutexLock` | `int` mutex | `void` | 获取互斥锁 | `thread.mutexLock(m);` |
| `thread.mutexUnlock` | `int` mutex | `void` | 释放互斥锁 | `thread.mutexUnlock(m);` |
| `thread.mutexDestroy` | `int` mutex | `void` | 销毁互斥锁 | `thread.mutexDestroy(m);` |

## 9. dynlib 库（动态库加载）

| 函数名 | 参数 | 返回值 | 功能说明 | 示例 |
|--------|------|--------|----------|------|
| `dynlib.load` | `string` path | `int` | 加载 DLL/SO | `var h = new dynlib.load("user32.dll");` |
| `dynlib.get` | `int` h, `string` name | `int` | 获取函数地址 | `var p = new dynlib.get(h, "MessageBoxA");` |
| `dynlib.call` | `int` p, `int` arg | `int` | 调用函数 (Int->Int) | `dynlib.call(p, 0);` |
| `dynlib.unload` | `int` h | `void` | 卸载库 | `dynlib.unload(h);` |
